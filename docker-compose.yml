version: "3.3"

secrets:
  musicbot:
    file: ./secrets/musicbot.txt

services:
  http:
    build: ./http
    ports:
      - "8080:80"

  minecraft:
    image: itzg/minecraft-server:java11
    ports:
      - "25565:25565"
    environment:
      EULA: "TRUE"
      JVM_OPTS: "-DIReallyKnowWhatIAmDoingISwear=true"
      MEMORY: 2G
      TYPE: SPIGOT
      VERSION: 1.16.5
      GAMEMODE: survival
      DIFFICULTY: normal
      EXTRA_ARGS: "--world-dir ./worlds/"
    volumes:
      - ./minecraft/server:/data

  discord:
    build: ./discord

  musicbot:
    build: ./musicbot
    environment:
      PASS_FILE: /run/secrets/musicbot
    secrets:
      - musicbot

  media:
    image: linuxserver/jellyfin
    volumes:
      - ./media/shows:/data/tvshows
      - ./media/movies:/data/movies
